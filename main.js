/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var tt=Object.create;var A=Object.defineProperty;var et=Object.getOwnPropertyDescriptor;var st=Object.getOwnPropertyNames;var it=Object.getPrototypeOf,nt=Object.prototype.hasOwnProperty;var at=(b,S)=>{for(var e in S)A(b,e,{get:S[e],enumerable:!0})},q=(b,S,e,o)=>{if(S&&typeof S=="object"||typeof S=="function")for(let m of st(S))!nt.call(b,m)&&m!==e&&A(b,m,{get:()=>S[m],enumerable:!(o=et(S,m))||o.enumerable});return b};var Y=(b,S,e)=>(e=b!=null?tt(it(b)):{},q(S||!b||!b.__esModule?A(e,"default",{value:b,enumerable:!0}):e,b)),rt=b=>q(A({},"__esModule",{value:!0}),b);var ot={};at(ot,{default:()=>H});module.exports=rt(ot);var y=require("obsidian"),k=Y(require("path")),M=Y(require("fs")),F=require("child_process"),Q={githubRepoUrl:"",localMarkdownPath:"",gitPassword:"",gitAuthorName:"",gitAuthorEmail:"",localRunPort:"8080",localKremsBinaryPath:"",alternativeCSSDir:"",alternativeJSDir:"",alternativeFavicon:""},H=class extends y.Plugin{constructor(){super(...arguments);this.isKremsLocallyRunning=!1;this.localKremsProcess=null}async onload(){await this.loadSettings(),this.addRibbonIcon("cloud-lightning","Krems Publisher",e=>{new O(this.app,this).open()}),this.addSettingTab(new j(this.app,this)),console.log("Krems Obsidian Plugin loaded.")}onunload(){this.localKremsProcess&&(console.log("Krems Obsidian Plugin unloading: Killing active Krems process."),this.localKremsProcess.kill(),this.localKremsProcess=null,this.isKremsLocallyRunning=!1),console.log("Krems Obsidian Plugin unloaded.")}async loadSettings(){this.settings=Object.assign({},Q,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}async execShellCommand(e,o,m,t){return new Promise((i,c)=>{let l=m?{...process.env,...m}:process.env,a=t||e;(0,F.exec)(e,{cwd:o,env:l},(u,d,_)=>{let C={stdout:d.trim(),stderr:_.trim()};if(u){console.error(`Command failed: ${a}
Error: ${u.message}
Stdout: ${C.stdout}
Stderr: ${C.stderr}`),c({message:`Command failed: ${a}. Error: ${u.message}`,stdout:C.stdout,stderr:C.stderr,originalError:u});return}C.stderr&&console.warn(`Command successful but stderr present: ${a}
Stderr: ${C.stderr}`),i(C)})})}getKremsBinaryDir(){return k.join(this.app.vault.configDir,"plugins",this.manifest.id,"bin")}getKremsBinaryName(){switch(process.platform){case"win32":return"krems-windows-amd64.exe";case"darwin":return"krems-darwin-amd64";case"linux":return"krems-linux-amd64";default:return""}}async ensureKremsBinary(e){let o=this.getKremsBinaryName();if(!o)return e("Unsupported operating system for Krems download.","error"),null;let m=this.getKremsBinaryDir(),t=k.join(m,o),i=this.app.vault.adapter.getBasePath(),c=k.join(i,t);this.settings.localKremsBinaryPath=t,await this.saveSettings();let l=this.app.vault.adapter;try{if(await l.exists(t)){if(e("Krems binary already downloaded.","status"),process.platform!=="win32")try{M.chmodSync(c,493)}catch(a){return console.error("Failed to chmod existing binary:",a),e("Found Krems binary, but failed to set executable permission. Please check manually.","error"),null}return t}}catch(a){console.error("Error checking for existing Krems binary:",a),e("Error checking for existing Krems binary. Attempting download.","error")}e(`Downloading Krems for ${process.platform}...`,"status");try{await l.exists(m)||await l.mkdir(m);let a=`https://github.com/mreider/krems/releases/latest/download/${o}`,u=await(0,y.requestUrl)({url:a,method:"GET"});if(u.status!==200)throw new Error(`Failed to download Krems: Server responded with ${u.status}`);return await l.writeBinary(t,u.arrayBuffer),e("Krems downloaded successfully.","status"),process.platform!=="win32"&&(e("Setting executable permissions...","status"),M.chmodSync(c,493),e("Permissions set.","status")),t}catch(a){return console.error("Krems download error:",a),e(`Failed to download Krems: ${a.message||a.toString()}`,"error"),null}}},O=class extends y.Modal{constructor(e,o){super(e);this.plugin=o}async checkIfDirIsEmpty(e){try{let m=await this.app.vault.adapter.list(e);return m.files.length===0&&m.folders.length===0}catch(o){return console.warn(`Error listing contents of '${e}':`,o),!1}}async onOpen(){let{contentEl:e}=this;e.empty(),e.createEl("h2",{text:"Krems Publisher Actions"});let o=e.createDiv({cls:"krems-modal-section"});o.createEl("h4",{text:"1. Initialize Local Directory"});let m=o.createEl("p",{text:`This will clone krems-example into your specified local directory (${this.plugin.settings.localMarkdownPath||"not set"}) and set its remote to your GitHub repo.`});this.initButton=o.createEl("button",{text:"Initialize Directory"}),this.initFeedbackEl=o.createEl("div",{cls:"krems-feedback",attr:{style:"margin-top: 10px;"}});let t=o.createEl("p",{cls:"krems-warning",attr:{style:"display: none;"}}),i=(n,s)=>{this.initFeedbackEl.textContent=n,this.initFeedbackEl.className=`krems-feedback krems-feedback-${s}`},c=this.plugin.settings.localMarkdownPath,l=!!this.plugin.settings.githubRepoUrl;!c||!l?(this.initButton.disabled=!0,t.textContent="Please set Local Markdown Directory and GitHub Repo URL in settings.",t.style.display="block"):this.app.vault.adapter.stat(c).then(async s=>{s?s.type==="folder"?await this.checkIfDirIsEmpty(c)?(t.style.display="none",this.initButton.disabled=!1):(this.initButton.disabled=!0,t.textContent=`Directory '${c}' is not empty. Can only initialize empty directories.`,t.style.display="block"):(this.initButton.disabled=!0,t.textContent=`Path '${c}' is a file, not a directory. Initialization requires a directory path.`,t.style.display="block"):(t.style.display="none",this.initButton.disabled=!1)}).catch(s=>{console.error(`Error checking path '${c}' for init button state:`,s),this.initButton.disabled=!0,t.textContent="Error checking local directory status. Initialization disabled.",t.style.display="block"}),this.initButton.addEventListener("click",async()=>{let{localMarkdownPath:n,githubRepoUrl:s}=this.plugin.settings;if(!n||!s){i("Error: Local Markdown Directory and GitHub Repo URL must be set in plugin settings.","error");return}let L=this.app.vault.adapter.getBasePath(),v=k.join(L,n);if(await this.app.vault.adapter.exists(v)&&!await this.checkIfDirIsEmpty(v)){i(`Error: Directory '${n}' is not empty. Please choose an empty or new directory.`,"error");return}this.initButton.disabled=!0,i("Cloning krems-example repository...","status");try{let h=`git clone https://github.com/mreider/krems-example "${v}"`;await this.plugin.execShellCommand(h,L,void 0,"git clone <example-repo> <path>"),i("Repository cloned. Setting remote URL...","status");let P=`git -C "${v}" remote set-url origin "${s}"`;await this.plugin.execShellCommand(P,L,void 0,"git remote set-url origin <user-repo-url>"),i("Remote URL set. Creating config.yaml...","status");let g=s.substring(s.lastIndexOf("/")+1),x=`https://${s.split("/")[2]}/${g}`,f=`website:
`;f+=`  url: "${x}"
`,f+=`  name: "${g} Site"
`,f+=`  basePath: "/${g}"
`,f+=`  devPath: "/"
`,this.plugin.settings.alternativeCSSDir&&(f+=`  alternativeCSSDir: "${this.plugin.settings.alternativeCSSDir}"
`),this.plugin.settings.alternativeJSDir&&(f+=`  alternativeJSDir: "${this.plugin.settings.alternativeJSDir}"
`),this.plugin.settings.alternativeFavicon&&(f+=`  alternativeFavicon: "${this.plugin.settings.alternativeFavicon}"
`),f+=`
menu:
`,f+=`  - title: "Home"
`,f+=`    path: "index.md"
`;let r=k.join(n,"config.yaml");await this.app.vault.adapter.write(r,f),i("config.yaml created. Cleaning up example README.md...","status");let p=k.join(n,"README.md");await this.app.vault.adapter.exists(p)?(await this.app.vault.adapter.remove(p),i("Directory initialized successfully! README.md removed, config.yaml created.","success")):i("Directory initialized successfully! config.yaml created. (README.md not found to remove).","success")}catch(h){console.error("Initialization error:",h.message||h);let P=h.stderr||h.message||h.toString();i(`Initialization failed: ${P}`,"error")}finally{this.initButton.disabled=!1}});let a=e.createDiv({cls:"krems-modal-section"});a.createEl("h4",{text:"Clean and Clone Repository"}),a.createEl("p",{text:`This will completely WIPE the local directory '${this.plugin.settings.localMarkdownPath||"not set"}' and re-clone your site from the master/main branch of your configured GitHub repository. Use with caution!`}),a.createEl("p",{text:"WARNING: This action is destructive and will delete all local changes in the target directory not pushed to your remote repository.",cls:"krems-warning"}),this.cleanCloneButton=a.createEl("button",{text:"Clean and Clone Directory"}),this.cleanCloneFeedbackEl=a.createEl("div",{cls:"krems-feedback",attr:{style:"margin-top: 10px;"}});let u=a.createEl("p",{cls:"krems-warning",attr:{style:"display: none;"}}),d=(n,s)=>{this.cleanCloneFeedbackEl.textContent=n,this.cleanCloneFeedbackEl.className=`krems-feedback krems-feedback-${s}`};(()=>{let{localMarkdownPath:n,githubRepoUrl:s}=this.plugin.settings;!n||!s?(this.cleanCloneButton.disabled=!0,u.textContent="Please set Local Markdown Directory and GitHub Repo URL in settings.",u.style.display="block"):(this.cleanCloneButton.disabled=!1,u.style.display="none")})(),this.cleanCloneButton.addEventListener("click",async()=>{let{localMarkdownPath:n,githubRepoUrl:s}=this.plugin.settings;if(!n||!s){d("Error: Local Markdown Directory and GitHub Repo URL must be set.","error");return}if(!confirm(`ARE YOU SURE?
This will delete everything in '${n}' and clone a fresh copy from '${s}'. This action cannot be undone.`)){d("Clean and Clone operation cancelled by user.","status");return}this.cleanCloneButton.disabled=!0,d("Starting Clean and Clone operation...","status");let v=this.app.vault.adapter.getBasePath(),h=k.join(v,n),P=this.app.vault.adapter;try{if(await P.exists(n)){if(d(`Deleting existing directory: ${n}...`,"status"),!h.startsWith(v))throw new Error("Security check failed: Path to delete is outside the vault.");try{await M.promises.rm(h,{recursive:!0,force:!0}),d(`Directory ${n} deleted.`,"status")}catch(r){console.error(`Error deleting directory with fs.promises.rm: ${h}`,r),d(`Failed to delete directory '${n}': ${r.message}. Please ensure the directory is not in use and try again, or remove it manually.`,"error"),this.cleanCloneButton.disabled=!1;return}}else d(`Directory ${n} does not exist. Proceeding to clone.`,"status");let g=k.dirname(n);g&&g!=="."&&!await P.exists(g)&&await P.mkdir(g),d(`Cloning from ${s} into ${n}...`,"status");let x=s;if(s.startsWith("https://github.com/")){let r=s.substring(19);r.split("/").length===2&&!r.endsWith(".git")?(x=`git://github.com/${r}.git`,d(`Using git:// protocol: ${x}`,"status")):d(`Using provided HTTPS URL for clone: ${s}`,"status")}else s.startsWith("git@github.com:")&&d(`Using provided SSH URL for clone: ${s}`,"status");let f=`git clone --depth 1 ${x} "${h}"`;await this.plugin.execShellCommand(f,v,void 0,"git clone <repo_url> <path>"),d("Repository cloned successfully.","success")}catch(g){console.error("Clean and Clone error:",g.message||g);let x=g.stderr||g.message||g.toString();d(`Clean and Clone failed: ${x}`,"error")}finally{this.cleanCloneButton.disabled=!1}});let C=e.createDiv({cls:"krems-modal-section"});C.createEl("h4",{text:"2. Preview Site Locally"}),this.browseLocallyButton=C.createEl("button",{text:"Browse Locally"}),this.stopKremsButton=C.createEl("button",{text:"Stop Local Server"});let R=C.createEl("div",{cls:"krems-feedback",attr:{style:"margin-top: 10px; white-space: pre-wrap; background-color: var(--background-secondary); padding: 5px; border-radius: 3px; max-height: 150px; overflow-y: auto;"}}),N=C.createEl("p",{cls:"krems-warning",attr:{style:"display: none;"}}),w=(n,s)=>{s==="log"?(R.textContent+=n+`
`,R.scrollTop=R.scrollHeight):R.textContent=n,R.className=`krems-feedback krems-feedback-${s}`},K=()=>{this.plugin.isKremsLocallyRunning?(this.browseLocallyButton.setText("Server Running"),this.browseLocallyButton.disabled=!0,this.stopKremsButton.disabled=!1):(this.browseLocallyButton.setText("Browse Locally"),this.browseLocallyButton.disabled=!1,this.stopKremsButton.disabled=!0);let{localMarkdownPath:n}=this.plugin.settings;n?N.style.display="none":(this.browseLocallyButton.disabled=!0,this.stopKremsButton.disabled=!0,N.textContent="Please set Local Markdown Directory in settings.",N.style.display="block")};K(),this.browseLocallyButton.addEventListener("click",async()=>{var f,r;let{localMarkdownPath:n,localRunPort:s}=this.plugin.settings;if(!n){w("Error: Local Markdown Directory must be set.","error");return}if(this.browseLocallyButton.disabled=!0,w("Preparing local preview...","status"),!confirm("To preview your site locally, this will download the Krems binary (if not already present) and set executable permissions. This step is for local preview and not strictly necessary for publishing to GitHub. Is it okay to proceed?")){w("Local preview cancelled by user.","status"),K();return}let v=await this.plugin.ensureKremsBinary(w);if(!v){K();return}let h=this.app.vault.adapter.getBasePath(),P=k.join(h,v),g=k.join(h,n),x=s||Q.localRunPort||"8080";w(`Starting Krems server on port ${x}...`,"status");try{this.plugin.localKremsProcess=(0,F.spawn)(P,["--run","--port",x],{cwd:g,shell:process.platform==="win32"}),this.plugin.isKremsLocallyRunning=!0,K(),w(`Krems server starting on port ${x}. Output:
`,"log"),setTimeout(()=>{window.open(`http://localhost:${x}`,"_blank")},1500),(f=this.plugin.localKremsProcess.stdout)==null||f.on("data",p=>{w(p.toString(),"log")}),(r=this.plugin.localKremsProcess.stderr)==null||r.on("data",p=>{w(`[STDERR] ${p.toString()}`,"log")}),this.plugin.localKremsProcess.on("error",p=>{console.error("Failed to start Krems process:",p),w(`Failed to start Krems: ${p.message}`,"error"),this.plugin.isKremsLocallyRunning=!1,this.plugin.localKremsProcess=null,K()}),this.plugin.localKremsProcess.on("close",p=>{w(`Krems server exited with code ${p}.`,p===0?"status":"error"),this.plugin.isKremsLocallyRunning=!1,this.plugin.localKremsProcess=null,K()})}catch(p){console.error("Error spawning Krems:",p),w(`Error starting Krems: ${p.message||p.toString()}`,"error"),this.plugin.isKremsLocallyRunning=!1,this.plugin.localKremsProcess=null,K()}}),this.stopKremsButton.addEventListener("click",async()=>{this.plugin.localKremsProcess?(w("Stopping Krems server...","status"),this.plugin.localKremsProcess.kill()):(w("Krems server is not running.","status"),this.plugin.isKremsLocallyRunning=!1,K());let n=this.plugin.settings.localKremsBinaryPath,{localMarkdownPath:s}=this.plugin.settings;if(n&&s){let L=this.app.vault.adapter.getBasePath(),v=k.join(L,s),h=k.join(L,n);w("Cleaning up .tmp directory...","status");try{await this.plugin.execShellCommand(`"${h}" --clean`,v,void 0,"krems --clean"),w("Cleanup successful.","status")}catch(P){console.error("Krems clean error:",P),w(`Cleanup failed: ${P.stderr||P.message}`,"error")}}});let B=e.createDiv({cls:"krems-modal-section"});B.createEl("h4",{text:"4. Push Site to GitHub"}),B.createEl("p",{text:`This will add, commit, and push the content of '${this.plugin.settings.localMarkdownPath||"not set"}' to your GitHub repo.`});let $=B.createEl("input",{type:"text",placeholder:"Optional commit message (default: latest site version)"});$.style.width="100%",$.style.marginBottom="10px";let T=B.createEl("button",{text:"Push to GitHub"}),W=B.createEl("div",{cls:"krems-feedback",attr:{style:"margin-top: 10px;"}}),E=(n,s)=>{W.textContent=n,W.className=`krems-feedback krems-feedback-${s}`};T.addEventListener("click",async()=>{let{localMarkdownPath:n,githubRepoUrl:s,gitAuthorName:L,gitAuthorEmail:v,gitPassword:h}=this.plugin.settings;if(!n||!s){E("Error: Local Markdown Directory and GitHub Repo URL must be set in plugin settings.","error");return}let P=this.app.vault.adapter.getBasePath(),g=k.join(P,n),f=($.value.trim()||"latest site version").replace(/"/g,'\\"');T.disabled=!0,$.disabled=!0,E("Preparing to push site...","status");try{let r;E("Adding files (git add .)...","status"),r=await this.plugin.execShellCommand("git add .",g),r.stderr&&E(`Git add (warnings): ${r.stderr}`,"status"),E(`Committing with message: "${f}"...`,"status");let p=L||"Krems Obsidian Plugin",V=v||"krems-plugin@example.com",X={GIT_AUTHOR_NAME:p,GIT_AUTHOR_EMAIL:V,GIT_COMMITTER_NAME:p,GIT_COMMITTER_EMAIL:V};try{r=await this.plugin.execShellCommand(`git commit -m "${f}"`,g,X),r.stderr&&E(`Git commit (warnings): ${r.stderr}`,"status")}catch(D){if(D.stdout&&D.stdout.includes("nothing to commit"))E("No changes to commit. Proceeding to push...","status");else throw D}E("Pushing to remote repository...","status");let z="git push",J="git push";if(h&&s.startsWith("https://")){let D=s.substring(8),Z=`https://${h}@${D}`,I="main";try{r=await this.plugin.execShellCommand("git rev-parse --abbrev-ref HEAD",g),I=r.stdout,r.stderr&&E(`Git branch check (warnings): ${r.stderr}`,"status")}catch(G){console.warn("Could not determine current branch, defaulting to 'main'. Error:",G.message),E(`Warning: Could not determine current branch (using 'main'). Details: ${G.stderr||G.message}`,"status")}z=`git push ${Z} ${I}`,J=`git push <authenticated_url> ${I}`,E(`Pushing to ${s} (authenticated)...`,"status")}else E(`Pushing to ${s} (unauthenticated, ensure credential helper or SSH is set up)...`,"status");r=await this.plugin.execShellCommand(z,g,void 0,J),r.stderr?E(`Push successful with warnings: ${r.stderr}`,"success"):E("Site pushed successfully!","success")}catch(r){console.error("Push error:",r.message||r);let p=`Push failed: ${r.message||r.toString()}${r.stderr?`
Stderr: ${r.stderr}`:""}`;E(p,"error")}finally{T.disabled=!1,$.disabled=!1}}),(!this.plugin.settings.localMarkdownPath||!this.plugin.settings.githubRepoUrl)&&(T.disabled=!0,$.disabled=!0,B.createEl("p",{text:"Please set Local Markdown Directory and GitHub Repo URL in settings.",cls:"krems-warning"})),e.createEl("hr");let U=e.createEl("p",{cls:"krems-modal-footer"});U.setText("For help, see the "),U.createEl("a",{text:"plugin documentation",href:"https://github.com/mreider/krems-obsidian-plugin/",attr:{target:"_blank",rel:"noopener noreferrer"}}),U.appendText(".")}onClose(){let{contentEl:e}=this;e.empty()}},j=class extends y.PluginSettingTab{constructor(e,o){super(e,o);this.plugin=o}display(){let{containerEl:e}=this;e.empty(),e.createEl("h2",{text:"Krems Publisher Settings"});let o=(t,i,c,l)=>{t.classList.remove("krems-input-valid","krems-input-invalid"),i.classList.remove("krems-feedback-valid","krems-feedback-invalid"),i.textContent=c,i.style.display=c?"block":"none",c&&(t.classList.add(l?"krems-input-valid":"krems-input-invalid"),i.classList.add(l?"krems-feedback-valid":"krems-feedback-invalid"))};new y.Setting(e).setName("GitHub Repository URL").setDesc("HTTPS URL of your GitHub repository (e.g., https://github.com/username/repo). Do not include .git at the end.").addText(t=>{var c;let i=(c=t.inputEl.parentElement)==null?void 0:c.createEl("div",{cls:"krems-setting-feedback",attr:{style:"display: none; margin-top: 5px;"}});t.setPlaceholder("https://github.com/username/repo").setValue(this.plugin.settings.githubRepoUrl).onChange(async l=>{this.plugin.settings.githubRepoUrl=l.trim(),await this.plugin.saveSettings()}),t.inputEl.addEventListener("focusout",async()=>{let l=this.plugin.settings.githubRepoUrl,a=!0,u="";if(!l){o(t.inputEl,i,"",!0);return}if(!l.startsWith("https://github.com/"))a=!1,u="URL must start with https://github.com/";else if(l.endsWith(".git"))a=!1,u="URL should not end with .git";else{let d=l.substring(19).split("/");(d.length<2||!d[0]||!d[1])&&(a=!1,u="Invalid GitHub repository URL format.")}a&&u===""&&(u="URL format is valid."),o(t.inputEl,i,u,a)}),this.plugin.settings.githubRepoUrl&&t.inputEl.dispatchEvent(new Event("focusout"))}),new y.Setting(e).setName("Local Markdown Directory").setDesc("Path to the directory in your vault for your Krems site (e.g., MyKremsSite).").addText(t=>{var c;let i=(c=t.inputEl.parentElement)==null?void 0:c.createEl("div",{cls:"krems-setting-feedback",attr:{style:"display: none; margin-top: 5px;"}});t.setPlaceholder("e.g., MyKremsSite or path/to/site").setValue(this.plugin.settings.localMarkdownPath).onChange(async l=>{this.plugin.settings.localMarkdownPath=l.trim(),await this.plugin.saveSettings()}),t.inputEl.addEventListener("focusout",async()=>{let l=this.plugin.settings.localMarkdownPath,a=!1,u="";if(!l){o(t.inputEl,i,"",!0);return}let d=this.app.vault.getAbstractFileByPath(l);d&&d instanceof y.TFolder?(a=!0,u="Directory exists."):(a=!1,u="Directory not found in the vault."),o(t.inputEl,i,u,a)}),this.plugin.settings.localMarkdownPath&&t.inputEl.dispatchEvent(new Event("focusout"))}),new y.Setting(e).setName("GitHub Personal Access Token (PAT)").setDesc('Required for pushing to HTTPS repositories. Create a PAT on GitHub with "repo" and "workflow" scopes. See plugin README for instructions.').addText(t=>{t.inputEl.type="password",t.setPlaceholder("Enter your GitHub PAT").setValue(this.plugin.settings.gitPassword||"").onChange(async i=>{this.plugin.settings.gitPassword=i,await this.plugin.saveSettings()})}),new y.Setting(e).setName("Git Author Name").setDesc('Name to use for Git commits (e.g., Your Name). If blank, a default ("Krems Obsidian Plugin") will be used.').addText(t=>t.setPlaceholder("Your Name").setValue(this.plugin.settings.gitAuthorName||"").onChange(async i=>{this.plugin.settings.gitAuthorName=i.trim(),await this.plugin.saveSettings()})),new y.Setting(e).setName("Git Author Email").setDesc('Email to use for Git commits (e.g., your.email@example.com). If blank, a default ("krems-plugin@example.com") will be used.').addText(t=>t.setPlaceholder("your.email@example.com").setValue(this.plugin.settings.gitAuthorEmail||"").onChange(async i=>{this.plugin.settings.gitAuthorEmail=i.trim(),await this.plugin.saveSettings()})),new y.Setting(e).setName("Port for Local Server (Optional)").setDesc('Port for "Browse Locally" feature. Defaults to 8080 if blank or invalid.').addText(t=>{var c;let i=(c=t.inputEl.parentElement)==null?void 0:c.createEl("div",{cls:"krems-setting-feedback",attr:{style:"display: none; margin-top: 5px;"}});t.setPlaceholder("e.g., 8080").setValue(this.plugin.settings.localRunPort||"").onChange(async l=>{this.plugin.settings.localRunPort=l.trim(),await this.plugin.saveSettings()}),t.inputEl.addEventListener("focusout",()=>{let l=this.plugin.settings.localRunPort;if(!l){o(t.inputEl,i,"Using default port 8080.",!0);return}let a=parseInt(l,10);isNaN(a)||a<1024||a>65535?o(t.inputEl,i,"Invalid port. Must be a number between 1024-65535.",!1):o(t.inputEl,i,"Port is valid.",!0)}),this.plugin.settings.localRunPort&&t.inputEl.dispatchEvent(new Event("focusout"))}),e.createEl("h3",{text:"Alternative Asset Paths (Optional)"}),e.createEl("p",{text:'Specify paths relative to your "Local Markdown Directory" for custom CSS, JS, or favicon. If left blank, Krems defaults will be used.'}),new y.Setting(e).setName("Alternative CSS Directory").setDesc('Path to a directory containing your custom .css files (e.g., "my-styles/css").').addText(t=>t.setPlaceholder("e.g., assets/css").setValue(this.plugin.settings.alternativeCSSDir||"").onChange(async i=>{this.plugin.settings.alternativeCSSDir=i.trim(),await this.plugin.saveSettings()})),new y.Setting(e).setName("Alternative JS Directory").setDesc('Path to a directory containing your custom .js files (e.g., "my-scripts/js").').addText(t=>t.setPlaceholder("e.g., assets/js").setValue(this.plugin.settings.alternativeJSDir||"").onChange(async i=>{this.plugin.settings.alternativeJSDir=i.trim(),await this.plugin.saveSettings()})),new y.Setting(e).setName("Alternative Favicon File").setDesc('Path to your custom favicon file (e.g., "my-images/favicon.png").').addText(t=>t.setPlaceholder("e.g., assets/images/custom-favicon.ico").setValue(this.plugin.settings.alternativeFavicon||"").onChange(async i=>{this.plugin.settings.alternativeFavicon=i.trim(),await this.plugin.saveSettings()})),e.createEl("hr");let m=e.createEl("p",{cls:"krems-settings-footer"});m.setText("For plugin instructions, troubleshooting, and more information, please visit the "),m.createEl("a",{text:"plugin documentation on GitHub",href:"https://github.com/mreider/krems-obsidian-plugin/",attr:{target:"_blank",rel:"noopener noreferrer"}}),m.appendText(".")}};
